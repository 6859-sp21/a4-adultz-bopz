{"version":3,"sources":["Bubbles.js","utils/data-transform.js","utils/d3-config.js","App.js","index.js"],"names":["svg","view","label","node","focus","genRawData","a","d3","genNestedData","csvData","groupedByArtist","Array","from","d","ogArtist","map","item","groupedByBadword","badword","word","groupedBySong","songName","song","groupedByLyric","ogLyric","uniqueLyricGroup","name","children","genArtists","artistList","artist","value","type","sort","b","localeCompare","width","scale1","domain","scale2","scale3","color","Bubbles","songOrArtist","setSongOrArtist","useState","root","setRoot","d3Container","useRef","updateArtistTitle","shouldUpdate","textValue","depth","VIEW_ALL_OPTION","data","parent","transition","duration","style","text","shouldShowLabel","r","length","zoomTo","v","k","attr","x","y","zoom","event","altKey","tween","i","t","filter","this","display","on","useEffect","res","size","padding","sum","count","fetchData","remove","current","height","closeLyrics","append","feMerge","selectAll","descendants","slice","join","e","target","pageX","pageY","generateLyricPopup","stopPropagation","document","addEventListener","handleEscape","removeEventListener","key","innerHTML","child","kbLyric","generateLyricRow","songTitle","releasedYear","year","html","newFocus","id","className","ref","customStyles","control","base","backgroundColor","border","borderRadius","borderBottom","boxShadow","placeholder","singleValue","indicatorSeparator","dropdownIndicator","input","menu","option","state","fontSize","isSelected","isFocused","App","artists","setArtists","artistRes","autoFocus","options","onChange","styles","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.176aa9be.chunk.js","sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport * as d3 from \"d3\";\nimport { genNestedData } from \"./utils/data-transform\";\nimport { width, height, pack } from \"./utils/d3-config.js\";\nimport { VIEW_ALL_OPTION } from \"./App\";\nimport \"./Bubbles.css\";\n\nconst scale1 = d3\n  .scaleSequential(d3.interpolate(\"#00875A\", \"#ABF5D1\"))\n  .domain([0, 30]);\nconst scale2 = d3\n  .scaleSequential(d3.interpolate(\"#00B8D9\", \"#B3F5FF\"))\n  .domain([2, 8]);\nconst scale3 = d3\n  .scaleSequential(d3.interpolate(\"#C054BE\", \"#E1C7E0\"))\n  .domain([0, 8]);\n\n// TODO: Create scale 4\nconst color = [null, scale1, scale2, scale3, scale3];\n\nlet svg, view, label, node, focus;\n\nconst Bubbles = ({ songOrArtist, setSongOrArtist }) => {\n  const [root, setRoot] = useState(null);\n\n  const d3Container = useRef(null);\n\n  // don't call setSongOrArtist if title update is due to props change\n  const updateArtistTitle = (d, shouldUpdate) => {\n    let textValue;\n\n    if (d.depth === 0) {\n      // artist level\n      textValue = \"\";\n      if (shouldUpdate) setSongOrArtist(VIEW_ALL_OPTION);\n    } else if (d.depth === 1) {\n      // bad word level\n      if (shouldUpdate) {\n        setSongOrArtist({\n          value: d.data.name,\n          label: d.data.name,\n          type: \"artist\",\n        });\n      }\n      textValue = `Censored words in Kidz Bop songs by ${d.data.name}:`;\n    } else if (d.depth === 2) {\n      // song level\n      textValue = `Songs that ${d.parent.data.name} say(s) '${d.data.name}':`;\n    }\n\n    d3.select(\"#selectedArtistName\")\n      .transition()\n      .duration(200)\n      .style(\"opacity\", textValue === \"\" ? 0 : 1);\n\n    if (textValue) {\n      d3.select(\"#selectedArtistName\").text(textValue);\n    }\n  };\n\n  const shouldShowLabel = (d) => {\n    return (d.parent === root && d.r > d.data.name.length * 2) || d.depth > 1;\n  };\n\n  const zoomTo = (v) => {\n    const k = width / v[2];\n    view = v;\n    label.attr(\"transform\", (d) => {\n      return `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`;\n    });\n    node.attr(\n      \"transform\",\n      (d) => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`\n    );\n    node.attr(\"r\", (d) => d.r * k);\n  };\n\n  const zoom = (event, d) => {\n    focus = d;\n\n    const transition = svg\n      .transition()\n      .duration(event.altKey ? 7500 : 750)\n      .tween(\"zoom\", (d) => {\n        const i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2]);\n        return (t) => zoomTo(i(t));\n      });\n\n    node\n      .filter(function (d) {\n        return d.parent === focus || this.style.display === \"inline\";\n      })\n      .transition(transition)\n      .style(\"fill-opacity\", (d) => (d.parent === focus ? 1 : 0))\n      .on(\"start\", function (d) {\n        if (d.parent === focus) this.style.display = \"inline\";\n      })\n      .on(\"end\", function (d) {\n        if (d.parent !== focus) this.style.display = \"none\";\n      });\n\n    label\n      .filter(function (d) {\n        return d.parent === focus || this.style.display === \"inline\";\n      })\n      .transition(transition)\n      .style(\"fill-opacity\", (d) => (d.parent === focus ? 1 : 0))\n      .on(\"start\", function (d) {\n        if (shouldShowLabel(d)) this.style.display = \"inline\";\n      })\n      .on(\"end\", function (d) {\n        if (d.parent !== focus) this.style.display = \"none\";\n      });\n  };\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const res = await genNestedData();\n      const input = { name: \"artists\", children: res };\n      setRoot(pack(input));\n    };\n    fetchData();\n  }, []);\n\n  /* The useEffect Hook is for running side effects outside of React,\n       for instance inserting elements into the DOM using D3 */\n  useEffect(() => {\n    d3.selectAll(\"g > *\").remove();\n\n    if (root && d3Container.current) {\n      focus = root;\n\n      // viz container\n      svg = d3\n        .select(d3Container.current)\n        .attr(\"viewBox\", `-${width / 2} -${height / 2} ${width} ${height}`)\n        .style(\"display\", \"block\")\n        .style(\"height\", \"80vh\")\n        .style(\"margin\", \"0 -14px\")\n        .attr(\"text-anchor\", \"middle\")\n        .style(\"cursor\", \"pointer\")\n        .on(\"click\", (event) => {\n          if (focus !== root) {\n            if (d3.select(\"#lyrics\").style(\"z-index\") > 0) {\n              // Hide lyrics when escape button pushed\n              closeLyrics();\n            } else {\n              updateArtistTitle(focus.parent, true);\n              zoom(event, focus.parent);\n            }\n          }\n        });\n\n      // glow\n      const defs = svg.append(\"defs\");\n      const filter = defs.append(\"filter\").attr(\"id\", \"glow\");\n      filter\n        .append(\"feGaussianBlur\")\n        .attr(\"stdDeviation\", \"2\")\n        .attr(\"result\", \"coloredBlur\");\n      const feMerge = filter.append(\"feMerge\");\n      feMerge.append(\"feMergeNode\").attr(\"in\", \"coloredBlur\");\n      feMerge.append(\"feMergeNode\").attr(\"in\", \"SourceGraphic\");\n\n      // circle nodes\n      node = svg\n        .append(\"g\")\n        .selectAll(\"circle\")\n        .data(root.descendants().slice(1))\n        .join(\"circle\")\n        .attr(\"stroke\", (d) => {\n          if (typeof color[d.depth] === \"function\") {\n            return color[d.depth](d.r);\n          }\n        })\n        .attr(\"fill\", \"transparent\")\n        .style(\"display\", (d) => (d.parent === root ? \"inline\" : \"none\"))\n        .on(\"mouseover\", (e, d) => {\n          d3.select(e.target)\n            .attr(\"stroke-width\", 4)\n            .style(\"filter\", \"url(#glow)\");\n          if (!shouldShowLabel(d)) {\n            d3.select(\"#tooltip\")\n              .transition()\n              .duration(200)\n              .style(\"opacity\", 1)\n              .text(d.data.name);\n          }\n        })\n        .on(\"mousemove\", (e) => {\n          d3.select(\"#tooltip\")\n            .style(\"left\", e.pageX + 10 + \"px\")\n            .style(\"top\", e.pageY - 10 + \"px\");\n        })\n        .on(\"mouseout\", (e) => {\n          d3.select(e.target).attr(\"stroke-width\", 1).style(\"filter\", null);\n          d3.select(\"#tooltip\").transition().duration(200).style(\"opacity\", 0);\n        })\n        .on(\"click\", (event, d) => {\n          if (focus !== d) {\n            updateArtistTitle(d, true);\n\n            // Only zoom until you get to song level. Then reveal bad words in each song.\n            if (d.depth < 3) {\n              zoom(event, d);\n            } else if (d.depth === 3) {\n              generateLyricPopup(d.data);\n            }\n            event.stopPropagation();\n          }\n        });\n\n      // labels\n      label = svg\n        .append(\"g\")\n        .attr(\"pointer-events\", \"none\")\n        .attr(\"text-anchor\", \"middle\")\n        .selectAll(\"text\")\n        .data(root.descendants())\n        .join(\"text\")\n        .style(\"font\", (d) => (d.depth === 1 ? \"8px Lato\" : \"12px Lato\"))\n        .style(\"fill\", \"white\")\n        .style(\"fill-opacity\", (d) => (d.parent === root ? 1 : 0))\n        .style(\"display\", (d) => (shouldShowLabel(d) ? \"inline\" : \"none\"))\n        .text((d) => (!d.children ? d.data.songName : d.data.name));\n\n      // tooltip\n      d3.select(\"body\")\n        .append(\"div\")\n        .attr(\"id\", \"tooltip\")\n        .attr(\"style\", \"position: absolute; opacity: 0;\")\n        .style(\"color\", \"white\")\n        .style(\"background-color\", \"#334e68bb\")\n        .style(\"padding\", \"8px\")\n        .style(\"border-radius\", \"4px\");\n\n      // description text\n      d3.select(\"#selectedArtistName\")\n        .style(\"font-weight\", \"200\")\n        .style(\"text-align\", \"center\")\n        .style(\"margin-top\", \"0\")\n        .style(\"color\", \"var(--light-text)\")\n        .style(\"opacity\", \"0\")\n        .text(\"All Artists\");\n\n      // Lyric breakdown\n      d3.select(\"body\")\n        .append(\"div\")\n        .attr(\"id\", \"lyrics\")\n        .style(\"z-index\", \"-10\")\n        .style(\"position\", \"absolute\")\n        .style(\"opacity\", \"0\")\n        .style(\"width\", \"40vw\")\n        .style(\"height\", \"60vh\")\n        .style(\"left\", \"30%\")\n        .style(\"top\", \"20%\")\n        .style(\"overflow\", \"scroll\")\n        .style(\"color\", \"var(--light-text)\")\n        .style(\"font\", \"16px Lato\")\n        .style(\"background-color\", \"var(--dark-secondary)\")\n        .style(\"padding\", \"24px\")\n        .style(\"border-radius\", \"12px\");\n\n      d3.select(\"#lyrics\")\n        .append(\"button\")\n        .style(\"position\", \"absolute\")\n        .style(\"right\", \"12px\")\n        .style(\"top\", \"12px\")\n        .text(\"x\")\n        .on(\"click\", () => {\n          // Close lyric pop-up\n          d3.select(\"#lyrics\")\n            .transition()\n            .duration(200)\n            .style(\"z-index\", -10)\n            .style(\"opacity\", 0);\n        });\n\n      d3.select(\"#lyrics\")\n        .append(\"h2\")\n        .style(\"margin-top\", 0)\n        .style(\"text-align\", \"center\")\n        .attr(\"id\", \"lyrics-title\");\n\n      d3.select(\"#lyrics\")\n        .append(\"p\")\n        .style(\"text-align\", \"center\")\n        .attr(\"id\", \"lyrics-year\");\n\n      d3.select(\"#lyrics\").append(\"div\").attr(\"id\", \"lyrics-content\");\n\n      // esc key zooms out\n      zoomTo([root.x, root.y, root.r * 2]);\n      document.addEventListener(\"keydown\", handleEscape);\n\n      return () => {\n        document.removeEventListener(\"keydown\", handleEscape);\n      };\n    }\n  }, [root]);\n\n  const closeLyrics = () => {\n    d3.select(\"#lyrics\")\n      .transition()\n      .duration(200)\n      .style(\"opacity\", 0)\n      .style(\"z-index\", -10);\n  };\n\n  const handleEscape = (e) => {\n    if (e.key === \"Escape\") {\n      if (d3.select(\"#lyrics\").style(\"z-index\") > 0) {\n        // Hide lyrics when escape button pushed\n        closeLyrics();\n      } else if (focus !== root) {\n        updateArtistTitle(focus.parent, true);\n        zoom(e, focus.parent);\n      }\n    }\n  };\n\n  const generateLyricRow = (data) => {\n    let ogHeader = `<b>${data.ogArtist}</b><br />`;\n    let ogLyricHTML =\n      '<div class=\"Bubbles-ogLyric\">\"' + data.ogLyric + '\"</div>';\n\n    let kbHeader = \"<b style='float:right'>Kidz Bop</b><br />\";\n    let kbLyricHTML =\n      data.kbLyric === \"cuts verse\"\n        ? '<div class=\"Bubbles-kbLyric\"><i>cuts verse</i></div>'\n        : '<div class=\"Bubbles-kbLyric\">\"' + data.kbLyric + '\"</div>';\n\n    return (\n      \"<div style='width:45%'>\" +\n      ogHeader +\n      ogLyricHTML +\n      \"</div>\" +\n      \"<div class='Bubbles-arrow'>--></div>\" +\n      \"<div style='width:45%'>\" +\n      kbHeader +\n      kbLyricHTML +\n      \"</div>\"\n    );\n  };\n\n  // Function to transform data into HTML content\n  const generateLyricPopup = (data) => {\n    // Merge all lyrics together\n    const innerHTML = data.children\n      .map((child) => {\n        return (\n          '<div class=\"Bubbles-lyricRow\">' + generateLyricRow(child) + \"</div>\"\n        );\n      })\n      .join(\"\");\n\n    let { songName, ogArtist, year } = data.children[0];\n    const songTitle = songName + \" by \" + ogArtist;\n    const releasedYear = \"Released in \" + year + \".\";\n\n    // Fill in title of lyric popup\n    d3.select(\"#lyrics-title\")\n      .style(\"font-weight\", \"bold\")\n      .style(\"margin-bottom\", 0)\n      .text(songTitle);\n\n    // Fill in year of lyric popup\n    d3.select(\"#lyrics-year\")\n      .style(\"margin-top\", 0)\n      .style(\"margin-bottom\", \"8px\")\n      .text(releasedYear);\n\n    // Fill in content of lyric popup\n    d3.select(\"#lyrics-content\").html(innerHTML);\n\n    // Reveal lyric popup\n    d3.select(\"#lyrics\")\n      .transition()\n      .duration(200)\n      .style(\"z-index\", 10)\n      .style(\"opacity\", 1);\n  };\n\n  useEffect(() => {\n    if (songOrArtist && root) {\n      const newFocus = root\n        .descendants()\n        .filter((d) => d.data.name === songOrArtist.value)[0];\n      if (newFocus) {\n        zoom({}, newFocus);\n        updateArtistTitle(newFocus, false);\n      }\n    }\n  }, [songOrArtist, root, zoom]);\n\n  return (\n    <>\n      <h3 id=\"selectedArtistName\"></h3>\n      <svg\n        className=\"d3-component\"\n        width=\"100%\"\n        height=\"100%\"\n        ref={d3Container}\n      />\n    </>\n  );\n};\n\nexport default Bubbles;\n","import * as d3 from \"d3\";\n\nexport const genRawData = async () => {\n  return await d3.csv(\n    \"https://raw.githubusercontent.com/the-pudding/data/master/kidz-bop/KB_censored-lyrics.csv\"\n  );\n};\n\nexport const genNestedData = async () => {\n  const csvData = await genRawData();\n  let groupedByArtist = Array.from(d3.group(csvData, (d) => d.ogArtist)).map(\n    (item) => {\n      let groupedByBadword = Array.from(\n        d3.group(item[1], (d) => d.badword)\n      ).map((word) => {\n        let groupedBySong = Array.from(\n          d3.group(word[1], (d) => d.songName)\n        ).map((song) => { \n          // Remove repeated lyrics\n          let groupedByLyric = Array.from(\n            d3.group(song[1], (d) => d.ogLyric)\n          ).map((uniqueLyricGroup) => {\n            // uniqueLyricGroup = is a size-2 array with lyric and index 0 and array of data points at index 1\n            let dataEntries = uniqueLyricGroup[1];\n            let firstUniqueEntry = dataEntries[0];\n            return firstUniqueEntry;\n          })\n          return { name: song[0], children: groupedByLyric };\n        });\n        return { name: word[0], children: groupedBySong };\n      });\n      return { name: item[0], children: groupedByBadword };\n    }\n  );\n\n  return groupedByArtist;\n};\n\nexport const genArtists = async () => {\n  const csvData = await genRawData();\n  const artistList = Array.from(d3.group(csvData, d => d.ogArtist))\n    .map((artist) => { \n      return { label: artist[0], value: artist[0], type: \"artist\" }\n    })\n    .sort((a, b) => a.label.localeCompare(b.label));\n  return artistList;\n};\n\nexport const genSongs = async () => {\n  const csvData = await genRawData();\n  const songList = Array.from(d3.group(csvData, d => d.songName))\n    .map((song) => { \n      return { label: song[0], value: song[0], type: \"song\" }\n    })\n    .sort((a, b) => a.label.localeCompare(b.label));\n  return songList;\n};\n","import * as d3 from \"d3\";\n\n// svg colors + dims\nexport const width = 500;\nexport const height = 500;\nexport const pack = (data) =>\n  d3.pack().size([width, height]).padding(3)(\n    d3\n      .hierarchy(data)\n      .sum((d) => d.count)\n      .sort((a, b) => b.count - a.count)\n  );\n","import { useState, useEffect } from \"react\";\nimport Select from \"react-select\";\nimport \"./App.css\";\nimport Bubbles from \"./Bubbles\";\nimport { genArtists } from \"./utils/data-transform\";\n\nexport const VIEW_ALL_OPTION = {\n  label: \"your favorite artist\",\n  value: \"all\",\n  type: \"all\",\n};\n\nconst customStyles = {\n  control: (base) => ({\n    ...base,\n    backgroundColor: \"var(--dark)\",\n    color: \"var(--light-text)\",\n    border: \"none\",\n    borderRadius: \"0\",\n    borderBottom: \"2px solid var(--light-green)\",\n    boxShadow: \"none\",\n    \"&:hover\": {\n      borderBottom: \"2px solid var(--blue)\",\n    },\n  }),\n  placeholder: (base) => ({\n    ...base,\n    backgroundColor: \"var(--dark)\",\n    color: \"var(--dark-text)\",\n  }),\n  singleValue: (base) => ({\n    ...base,\n    color: \"var(--light-text)\",\n  }),\n  indicatorSeparator: () => ({\n    display: \"none\",\n  }),\n  dropdownIndicator: (base) => ({\n    ...base,\n    color: \"var(--light-green)\",\n    \"&:hover\": {\n      color: \"var(--blue)\",\n    },\n  }),\n  input: (base) => ({\n    ...base,\n    color: \"var(--light-text)\",\n  }),\n  menu: (base) => ({\n    ...base,\n    backgroundColor: \"var(--dark)\",\n    color: \"var(--light-text)\",\n  }),\n  option: (base, state) => ({\n    ...base,\n    fontSize: \"16px\",\n    color: \"var(--light-text)\",\n    backgroundColor: state.isSelected\n      ? \"var(--blue)\"\n      : state.isFocused\n      ? \"var(--dark-green)\"\n      : \"var(--dark)\",\n  }),\n};\n\nconst App = () => {\n  const [songOrArtist, setSongOrArtist] = useState(null);\n  const [artists, setArtists] = useState([]);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const artistRes = await genArtists();\n      setArtists(artistRes);\n    };\n    fetchData();\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <div className=\"App-escape\">press ESC to zoom out</div>\n      {/* <h1 className=\"App-header\">What's your favorite artist spitting?</h1> */}\n      <div className=\"App-header\">\n        What's\n        <Select\n          className=\"App-select\"\n          autoFocus\n          placeholder=\"your favorite artist\"\n          options={[...artists]}\n          value={songOrArtist}\n          onChange={setSongOrArtist}\n          styles={customStyles}\n        />\n        spitting?\n      </div>\n      <Bubbles songOrArtist={songOrArtist} setSongOrArtist={setSongOrArtist} />\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}